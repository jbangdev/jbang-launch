environment:
  properties:
    jdkPathPrefix: 'target/jdks'
    jdkFilePrefix: 'zulu17.32.13-ca-jdk17.0.2'
    artifactsDir: out/jreleaser/assemble/jbang-launch/jpackage

project:
  name: jbang-launch
  description: JBang Launch desd
  longDescription: JBang Launch long desc
  links:
    homepage: https://github.com/jbangdev/jbang-launch
  authors:
    - Max Rydahl Andersen
  license: MIT
  inceptionYear: 2025
  stereotype: CLI
  languages:
    java:
      version: 11
      groupId: dev.jbang.launch
      artifactId: jbang-launch
      mainClass: dev.jbang.launch.JBangLaunch

platform:
  replacements:
    aarch_64: aarch64

release:
  github:
    overwrite: true
    changelog:
      formatted: ALWAYS
      preset: conventional-commits
      contributors:
        format: '- {{contributorName}}{{#contributorUsernameAsLink}} ({{.}}){{/contributorUsernameAsLink}}'

assemble:
  jlink:
    jbang-launch-jlink:
      active: ALWAYS
      exported: false
      imageName: 'jbang-launch-{{projectVersion}}'
      executable: jbang-launch
      targetJdks:
        - path: '{{jdkPathPrefix}}/zulu17OsxIntel/{{jdkFilePrefix}}-macosx_x64/zulu-17.jdk/Contents/Home'
          platform: 'osx-x86_64'
        - path: '{{jdkPathPrefix}}/zulu17OsxArm/{{jdkFilePrefix}}-macosx_aarch64/zulu-17.jdk/Contents/Home'
          platform: 'osx-aarch_64'
        - path: '{{jdkPathPrefix}}/zulu17LinuxIntel/{{jdkFilePrefix}}-linux_x64'
          platform: 'linux-x86_64'
        - path: '{{jdkPathPrefix}}/zulu17WindowsIntel/{{jdkFilePrefix}}-win_x64'
          platform: 'windows-x86_64'
      mainJar:
        path: 'target/jbang-launch-{{projectVersion}}.jar'

  jpackage:
    jbang-launch:
      verbose: true
      active: ALWAYS
      jlink: jbang-launch-jlink
      attachPlatform: true
      exported: false
      applicationPackage:
        appName: jbang-launch
        appVersion: '{{projectVersionNumber}}'
        vendor: jbangdev
       
      osx:
        types: [pkg,dmg]
        appName: jbang-launch
        packageName: JBangLaunch
        packageIdentifier: dev.jbang.launch.jbang-launch
        icon: 'src/media/jbang.icns'
        resourceDir: src/jpackage/osx
      linux:
        types: [deb,rpm]
        maintainer: jbang@jbang.dev
        icon: 'src/media/icon_256x256.png'
      windows:
        types: [msi]
        console: false
        dirChooser: true
        icon: 'src/media/jbang.ico'
        resourceDir: src/jpackage/windows

distributions:
  jbang-launch:
    type: NATIVE_PACKAGE
    artifacts:
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-osx-x86_64.pkg'
        platform: 'osx-x86_64'
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-osx-aarch64.pkg'
        platform: 'osx-aarch_64'
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-osx-x86_64.dmg'
        platform: 'osx-x86_64'
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-osx-aarch64.dmg'
        platform: 'osx-aarch_64'
      - path: '{{artifactsDir}}/{{distributionName}}_{{projectVersionNumber}}-1_amd64.deb'
        platform: 'linux-x86_64'
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-1.x86_64.rpm'
        platform: 'linux-x86_64'
      - path: '{{artifactsDir}}/{{distributionName}}-{{projectVersionNumber}}-windows-x86_64.msi'
        platform: 'windows-x86_64'
